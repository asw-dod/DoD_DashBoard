<template>
  <div>
    <v-row>
      <v-col>
        <h2>
          ğŸ“Œì˜¤ëŠ˜ í•™ì‹ê³µì§€ <span v-on:click="openModal">[N/1 ê³„ì‚°í•˜ê¸°]</span>
        </h2>
        <v-carousel
          cycle
          height="300"
          :show-arrows="false"
          hide-delimiter-background
          delimiter-icon="mdi-minus"
          class="h_card"
          :style="{ 'background-color': '#F6F2D4' }"
        >
          <v-carousel-item>
            <v-col>
              <h2>ìˆ˜ë•ì „(ê³µí†µ: ê¹€ë°¥ ë¼ë©´)</h2>
              <h2>ìˆ˜ë•ì „ ì½”ë„ˆ1</h2>
              <p class="memu-size">ì •ì‹</p>
              <h2>ìˆ˜ë•ì „ ì½”ë„ˆ2</h2>
              <p class="memu-size">{{ this.input.suduck["cor2"] }}<br /></p>
              <h2>ìˆ˜ë•ì „ ì½”ë„ˆ3</h2>
              <p class="memu-size">{{ this.input.suduck["cor3"] }}<br /></p>
            </v-col>
          </v-carousel-item>
          <v-carousel-item>
            <v-col>
              <h2>ì •ë³´ê³µí•™ê´€(ê³µí†µ: ë¼ë©´)</h2>
              <h2>ì •ë³´ê³µí•™ê´€ ì½”ë„ˆ1</h2>
              <p class="memu-size">
                {{ this.input.inforamtion["cor1"] }}<br />
              </p>
              <h2>ì •ë³´ê³µí•™ê´€ ì½”ë„ˆ3</h2>
              <p class="memu-size">
                {{ this.input.inforamtion["cor3"] }}<br />
              </p>
            </v-col>
          </v-carousel-item>
        </v-carousel>
      </v-col>
    </v-row>
    <v-row>
      <v-col class="s_card">
        <h2>ğŸ“Œì˜¤ëŠ˜ ê¸°ìˆ™ì‚¬ ì‹ë‹¨ ê³µì§€</h2>
        <v-carousel
          cycle
          height="38vh"
          :show-arrows="false"
          hide-delimiter-background
          delimiter-icon="mdi-minus"
          class="h_card"
          :style="{ 'background-color': '#F6F2D4' }"
        >
          <v-carousel-item>
            <v-col>
              <h2>í–‰ë³µê¸°ìˆ™ì‚¬</h2>
              <h2>ì ì‹¬</h2>
              <p class="memu-size">
                [í•œì‹] {{ this.input.happy["lunch"] }}<br />[ì¼í’ˆ]{{
                  this.input.happy["lunch_s"]
                }}
              </p>
              <h2>ì €ë…</h2>
              <p class="memu-size">
                [í•œì‹] {{ this.input.happy["dinner"] }}<br />[ì¼í’ˆ]{{
                  this.input.happy["dinner_s"]
                }}
              </p>
            </v-col>
          </v-carousel-item>
          <v-carousel-item>
            <v-col>
              <h2>íš¨ë¯¼ê¸°ìˆ™ì‚¬</h2>
              <h2>ì•„ì¹¨</h2>
              <div v-if="this.color == 1">
                <p class="memu-size" style="color: #e1b643">
                  {{ this.input.hyomin["breakfast"] }}
                </p>
              </div>
              <div v-else>
                <p class="memu-size">
                  {{ this.input.hyomin["breakfast"] }}
                </p>
              </div>

              <h2>ì ì‹¬</h2>
              <div v-if="this.color1 == 1">
                <p class="memu-size" style="color: #e1b643">
                  {{ this.input.hyomin["lunch"] }}
                </p>
              </div>
              <div v-else>
                <p class="memu-size">
                  {{ this.input.hyomin["lunch"] }}
                </p>
              </div>

              <h2>ì €ë…</h2>
              <div v-if="this.color2 == 1">
                <p class="memu-size" style="color: #e1b643">
                  {{ this.input.hyomin["dinner"] }}
                </p>
              </div>
              <div v-else>
                <p class="memu-size">
                  {{ this.input.hyomin["dinner"] }}
                </p>
              </div>
            </v-col>
          </v-carousel-item>
        </v-carousel>
      </v-col>
    </v-row>
    <modal name="Calculator" :width="500" :height="440">
      <v-container>
        <h2>1ëª… ë‹¹ {{ this.result }}ì› ì…ë‹ˆë‹¤.</h2>
        <p>{{ this.pricenum }} / {{ this.personnum }}</p>
        <v-row>
          <v-col
            ><v-text-field
              v-on:click="price"
              v-model="pricenum"
              label="ê°€ê²©?"
            ></v-text-field
          ></v-col>
          <v-col
            ><v-text-field
              v-on:click="person"
              v-model="personnum"
              label="ëª‡ëª…?"
            ></v-text-field
          ></v-col>
        </v-row>
        <v-row style="text-align: center">
          <v-col v-on:click="numberB(1)">1</v-col>
          <v-col v-on:click="numberB(2)">2</v-col>
          <v-col v-on:click="numberB(3)">3</v-col>
        </v-row>
        <v-row style="text-align: center">
          <v-col v-on:click="numberB(4)">4</v-col>
          <v-col v-on:click="numberB(5)">5</v-col>
          <v-col v-on:click="numberB(6)">6</v-col>
        </v-row>
        <v-row style="text-align: center">
          <v-col v-on:click="numberB(7)">7</v-col>
          <v-col v-on:click="numberB(8)">8</v-col>
          <v-col v-on:click="numberB(9)">9</v-col>
        </v-row>
        <v-row style="text-align: center">
          <v-col v-on:click="numberB(0)">0</v-col>
          <v-col v-on:click="zero2">00</v-col>
          <v-col v-on:click="Reset_return">Reset</v-col>
        </v-row>
        <br>
        <p>*ì†Œìˆ˜ì ìœ¼ë¡œëŠ” ë³€í™˜ì´ ì•ˆë¨ë‹ˆë‹¤. <br> 
        *ì°½ë¥¼ ë‹«ì„ë ¤ë©´ ì°½ë°– ì•„ë¬´ê³³ì´ë‚˜ ëˆ„ë£¨ì„¸ìš”</p>
      </v-container>
    </modal>
  </div>
</template>
<script>
import dayjs from "dayjs";
import axios from "axios";
import "dayjs/locale/ko";
export default {
  name: "foodviews",
  components: {},
  data: function () {
    //ì²˜ìŒ ë°ì´í„° ì„¸íŒ…
    return {
      input: {
        hyomin: "",
        happy: "",
        inforamtion: [],
        suduck: [],
      },
      //ê·¸ì™¸ ì¶”ê°€í•˜ëŠ”ê±°
      color: 0,
      color1: 0,
      color2: 0,
      //ê³„ì‚°ê¸°
      num_signal: 0,
      pricenum: "",
      personnum: "",
      result: 0,
    };
  },
  methods: {
    openModal() {
      this.$modal.show("Calculator");
      this.num_signal = 0;
      this.pricenum = "";
      this.personnum = "";
      this.result = 0;
    },
    price() {
      this.num_signal = 0;
    },
    person() {
      this.num_signal = 1;
      console.log(this.num_signal);
    },
    numberB(value) {
      const string = value.toString()
      if (this.num_signal == 0) {
        this.pricenum += string;
      } else {
        this.personnum += string;
      }
      this.result = parseInt(this.pricenum) / parseInt(this.personnum);
      this.result = parseInt(this.result);
    },
    zero2() {
      if (this.num_signal == 0) {
        this.pricenum += "00";
      } else {
        this.personnum += "00";
      }
      this.result = parseInt(this.pricenum) / parseInt(this.personnum);
      this.result = parseInt(this.result);
    },
    Reset_return() {
      this.pricenum = "";
      this.personnum = "";
    },
  },
  async mounted() {
    //ë³€ìˆ˜ë¥¼ ì ëŠ” ê³³
    let response = "";
    //funì„ ì ëŠ”ê³³(ë°˜ë³µì„ ìœ„í•´ì„œ funì„ ì„°ë‹¤.)
    //ì´ funì€ ê¸°ìˆ™ì‚¬ë¥¼ íŒŒì‹±í•´ì„œ ì €ì¥í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.
    async function getfood(typei, data) {
      const time = dayjs().format("YYYY-MM-DD");
      //í–‰ë³µê¸°ìˆ™ì‚¬ìš©
      if (typei == "happy") {
        try {
          for (let index = 0; index < data["happy"].length; index++) {
            if (data["happy"][index].Date == time) {
              return data["happy"][index];
            }
          }
        } catch (error) {
          return {
            breakfast: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
            lunch: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
            lunch_s: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
            dinner: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
            dinner_s: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
          };
        }
        //íš¨ë¯¼ê¸°ìˆ™ì‚¬ìš©
      } else if (typei == "hyomin") {
        try {
          for (let index = 0; index < data["hyomin"].length; index++) {
            if (data["hyomin"][index].Date == time) {
              return data["hyomin"][index];
            }
          }
        } catch (error) {
          return {
            breakfast: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
            lunch: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
            lunch_s: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
            dinner: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
            dinner_s: "ì—†ê±°ë‚˜ Apiì„œë²„ ì˜¤ë¥˜ ë°œìƒ",
          };
        }
      } else if (typei == "inforamtion") {
        try {
          return {
            cor1: data["inforamtion"]["ì •ë³´ê³µí•™ê´€ ì½”ë„ˆ1"][0]["menuName"],
            cor3: data["inforamtion"]["ì •ë³´ê³µí•™ê´€ ì½”ë„ˆ3"][0]["menuName"],
          };
        } catch (error) {
          return {
            cor1: "ì—†ìŠµ",
            cor3: "ì—†ìŠµ",
          };
        }
      } else if (typei == "suduck") {
        try {
          let temp1 = "ì—†ìŠµ", temp2 = "ì—†ìŠµ";
           //set data["suduck"]["ìˆ˜ë•ì „ ì½”ë„ˆ1"][0]["menuName"] 
          if(data["suduck"]["ìˆ˜ë•ì „ ì½”ë„ˆ2"] == undefined){
            temp2 = data["suduck"]["ìˆ˜ë•ì „ ì½”ë„ˆ3"][0]["menuName"]
          }else if(data["suduck"]["ìˆ˜ë•ì „ ì½”ë„ˆ3"] == undefined){
            temp2 = data["suduck"]["ìˆ˜ë•ì „ ì½”ë„ˆ2"][0]["menuName"];
          }
           return {
             cor2: temp1,
             cor3: temp2
           };
        }catch(error){
          console.log(error)
          return {
            cor2: "Error!",
            cor3: "Error!",
          }
        }

      }          
    }
    //ì²˜ìŒì— í•œë²ˆë§Œ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ëŠ”ê³³
    response = await axios(
      "https://raw.githubusercontent.com/asw-dod/Deu_food_api/master/output/api.json"
    );
    this.input.happy = await getfood("happy", response.data);
    this.input.hyomin = await getfood("hyomin", response.data);
    this.input.inforamtion = await getfood("inforamtion", response.data);
    this.input.suduck = await getfood("suduck", response.data);
    if (this.input.hyomin["breakfast"].includes("íŠ¹ì‹")) {
      this.color = 1;
    }
    if (this.input.hyomin["lunch"].includes("íŠ¹ì‹")) {
      this.color1 = 1;
    }
    if (this.input.hyomin["dinner"].includes("íŠ¹ì‹")) {
      this.color2 = 1;
    }
  },
};
</script>
